/**
 * JEMCC test program to test the bytecode driven class linking hierarchies.
 * Copyright (C) 1999-2004 J.M. Heisz 
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * See the file named COPYRIGHT in the root directory of the source
 * distribution for specific references to the GNU General Public License,
 * as well as further clarification on your rights to use this software.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
#include "jeminc.h"

/* Read the JNI/JEMCC internal details */
#include "jem.h"

/* External elements from uvminit.c */
extern JNIEnv *createTestEnv();
extern jint initializeTestCoreClasses(JNIEnv *env);
extern void destroyTestEnv(JNIEnv *env);

/* Test flags/data values for condition setups and tests */
int failureTotal;
#ifdef ENABLE_ERRORSWEEP
int testFailureCurrentCount, testFailureCount;

int JEM_CheckErrorSweep(int sweepType) {
    /* Note: don't care about sweep type */
    testFailureCurrentCount++;
    if ((testFailureCount >= 0) &&
        (testFailureCurrentCount == testFailureCount)) {
        return JNI_TRUE;
    }
    return JNI_FALSE;
}
#endif

/* Storage buffer for exception class and message (failure verification) */
int quietMode = JNI_FALSE;
char exClassName[256], exMsg[4096];

void checkException(const char *checkClassName, const char *checkMsg,
                    const char *tstName) {
    if ((checkClassName != NULL) &&
        (strstr(exClassName, checkClassName) == NULL)) {
        (void) fprintf(stderr, "Fatal exception failure on %s\n", tstName);
        (void) fprintf(stderr, "Expected %s, got %s instead.\n",
                               checkClassName, exClassName);
        exit(1);
    }
    if ((checkMsg != NULL) && (strstr(exMsg, checkMsg) == NULL)) {
        (void) fprintf(stderr, "Fatal exception failure on %s\n", tstName);
        (void) fprintf(stderr, "Expected '%s', got '%s' instead.\n",
                               checkMsg, exMsg);
        exit(1);
    }
}

/* Hierarchical test cases (all valid) */
static struct ok_test_data {
    char *classDef;
    jbyte testData[1000];
    jsize testLength;
} okTests[] = {
    {  "public interface ZIF []",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x07, 0x07, 0x00, 0x05, 0x07, 0x00, 0x06,
        0x01, 0x00, 0x0a, 0x53, 0x6f, 0x75, 0x72, 0x63,
        0x65, 0x46, 0x69, 0x6c, 0x65, 0x01, 0x00, 0x08,
        0x5a, 0x49, 0x46, 0x2e, 0x6a, 0x61, 0x76, 0x61,
        0x01, 0x00, 0x03, 0x5a, 0x49, 0x46, 0x01, 0x00,
        0x10, 0x6a, 0x61, 0x76, 0x61, 0x2f, 0x6c, 0x61,
        0x6e, 0x67, 0x2f, 0x4f, 0x62, 0x6a, 0x65, 0x63,
        0x74, 0x06, 0x01, 0x00, 0x01, 0x00, 0x02, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x03, 0x00, 0x00, 0x00, 0x02, 0x00, 0x04}, 87
    },
    {  "public interface NIF [1, 2]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0a, 0x07, 0x00, 0x08, 0x07, 0x00, 0x09,
        0x01, 0x00, 0x09, 0x6d, 0x65, 0x74, 0x68, 0x6f,
        0x64, 0x4f, 0x6e, 0x65, 0x01, 0x00, 0x03, 0x28,
        0x29, 0x56, 0x01, 0x00, 0x09, 0x6d, 0x65, 0x74,
        0x68, 0x6f, 0x64, 0x54, 0x77, 0x6f, 0x01, 0x00,
        0x0a, 0x53, 0x6f, 0x75, 0x72, 0x63, 0x65, 0x46,
        0x69, 0x6c, 0x65, 0x01, 0x00, 0x08, 0x4e, 0x49,
        0x46, 0x2e, 0x6a, 0x61, 0x76, 0x61, 0x01, 0x00,
        0x03, 0x4e, 0x49, 0x46, 0x01, 0x00, 0x10, 0x6a,
        0x61, 0x76, 0x61, 0x2f, 0x6c, 0x61, 0x6e, 0x67,
        0x2f, 0x4f, 0x62, 0x6a, 0x65, 0x63, 0x74, 0x06,
        0x01, 0x00, 0x01, 0x00, 0x02, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x02, 0x04, 0x01, 0x00, 0x03, 0x00,
        0x04, 0x00, 0x00, 0x04, 0x01, 0x00, 0x05, 0x00,
        0x04, 0x00, 0x00, 0x00, 0x01, 0x00, 0x06, 0x00,
        0x00, 0x00, 0x02, 0x00, 0x07}, 133
    },
    {  "public interface LIF [3]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x09, 0x07, 0x00, 0x07, 0x07, 0x00, 0x08,
        0x01, 0x00, 0x0b, 0x6d, 0x65, 0x74, 0x68, 0x6f,
        0x64, 0x54, 0x68, 0x72, 0x65, 0x65, 0x01, 0x00,
        0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x0a, 0x53,
        0x6f, 0x75, 0x72, 0x63, 0x65, 0x46, 0x69, 0x6c,
        0x65, 0x01, 0x00, 0x08, 0x4c, 0x49, 0x46, 0x2e,
        0x6a, 0x61, 0x76, 0x61, 0x01, 0x00, 0x03, 0x4c,
        0x49, 0x46, 0x01, 0x00, 0x10, 0x6a, 0x61, 0x76,
        0x61, 0x2f, 0x6c, 0x61, 0x6e, 0x67, 0x2f, 0x4f,
        0x62, 0x6a, 0x65, 0x63, 0x74, 0x06, 0x01, 0x00,
        0x01, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x04, 0x01, 0x00, 0x03, 0x00, 0x04, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x05, 0x00, 0x00, 0x00,
        0x02, 0x00, 0x06}, 115
    },
    {  "public interface NZIF extends ZIF [1, 2, 3]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0d, 0x07, 0x00, 0x0a, 0x07, 0x00, 0x0b,
        0x07, 0x00, 0x0c, 0x01, 0x00, 0x09, 0x6d, 0x65,
        0x74, 0x68, 0x6f, 0x64, 0x4f, 0x6e, 0x65, 0x01,
        0x00, 0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x09,
        0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64, 0x54, 0x77,
        0x6f, 0x01, 0x00, 0x0b, 0x6d, 0x65, 0x74, 0x68,
        0x6f, 0x64, 0x54, 0x68, 0x72, 0x65, 0x65, 0x01,
        0x00, 0x0a, 0x53, 0x6f, 0x75, 0x72, 0x63, 0x65,
        0x46, 0x69, 0x6c, 0x65, 0x01, 0x00, 0x09, 0x4e,
        0x5a, 0x49, 0x46, 0x2e, 0x6a, 0x61, 0x76, 0x61,
        0x01, 0x00, 0x04, 0x4e, 0x5a, 0x49, 0x46, 0x01,
        0x00, 0x10, 0x6a, 0x61, 0x76, 0x61, 0x2f, 0x6c,
        0x61, 0x6e, 0x67, 0x2f, 0x4f, 0x62, 0x6a, 0x65,
        0x63, 0x74, 0x01, 0x00, 0x03, 0x5a, 0x49, 0x46,
        0x06, 0x01, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01,
        0x00, 0x03, 0x00, 0x00, 0x00, 0x03, 0x04, 0x01,
        0x00, 0x04, 0x00, 0x05, 0x00, 0x00, 0x04, 0x01,
        0x00, 0x06, 0x00, 0x05, 0x00, 0x00, 0x04, 0x01,
        0x00, 0x07, 0x00, 0x05, 0x00, 0x00, 0x00, 0x01,
        0x00, 0x08, 0x00, 0x00, 0x00, 0x02, 0x00, 0x09}, 168
    },
    {  "public interface ZNIF extends NIF []",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x09, 0x07, 0x00, 0x06, 0x07, 0x00, 0x07,
        0x07, 0x00, 0x08, 0x01, 0x00, 0x0a, 0x53, 0x6f,
        0x75, 0x72, 0x63, 0x65, 0x46, 0x69, 0x6c, 0x65,
        0x01, 0x00, 0x09, 0x5a, 0x4e, 0x49, 0x46, 0x2e,
        0x6a, 0x61, 0x76, 0x61, 0x01, 0x00, 0x04, 0x5a,
        0x4e, 0x49, 0x46, 0x01, 0x00, 0x10, 0x6a, 0x61,
        0x76, 0x61, 0x2f, 0x6c, 0x61, 0x6e, 0x67, 0x2f,
        0x4f, 0x62, 0x6a, 0x65, 0x63, 0x74, 0x01, 0x00,
        0x03, 0x4e, 0x49, 0x46, 0x06, 0x01, 0x00, 0x01,
        0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x04, 0x00, 0x00,
        0x00, 0x02, 0x00, 0x05}, 100
    },
    {  "public interface MZNIF extends ZIF, NIF [4]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0d, 0x07, 0x00, 0x09, 0x07, 0x00, 0x0a,
        0x07, 0x00, 0x0b, 0x07, 0x00, 0x0c, 0x01, 0x00,
        0x0a, 0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64, 0x46,
        0x6f, 0x75, 0x72, 0x01, 0x00, 0x03, 0x28, 0x29,
        0x56, 0x01, 0x00, 0x0a, 0x53, 0x6f, 0x75, 0x72,
        0x63, 0x65, 0x46, 0x69, 0x6c, 0x65, 0x01, 0x00,
        0x0a, 0x4d, 0x5a, 0x4e, 0x49, 0x46, 0x2e, 0x6a,
        0x61, 0x76, 0x61, 0x01, 0x00, 0x05, 0x4d, 0x5a,
        0x4e, 0x49, 0x46, 0x01, 0x00, 0x10, 0x6a, 0x61,
        0x76, 0x61, 0x2f, 0x6c, 0x61, 0x6e, 0x67, 0x2f,
        0x4f, 0x62, 0x6a, 0x65, 0x63, 0x74, 0x01, 0x00,
        0x03, 0x5a, 0x49, 0x46, 0x01, 0x00, 0x03, 0x4e,
        0x49, 0x46, 0x06, 0x01, 0x00, 0x01, 0x00, 0x02,
        0x00, 0x02, 0x00, 0x03, 0x00, 0x04, 0x00, 0x00,
        0x00, 0x01, 0x04, 0x01, 0x00, 0x05, 0x00, 0x06,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00,
        0x00, 0x02, 0x00, 0x08}, 140
    },
    {  "public interface MNZIF extends NIF, ZIF [4]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0d, 0x07, 0x00, 0x09, 0x07, 0x00, 0x0a,
        0x07, 0x00, 0x0b, 0x07, 0x00, 0x0c, 0x01, 0x00,
        0x0a, 0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64, 0x46,
        0x6f, 0x75, 0x72, 0x01, 0x00, 0x03, 0x28, 0x29,
        0x56, 0x01, 0x00, 0x0a, 0x53, 0x6f, 0x75, 0x72,
        0x63, 0x65, 0x46, 0x69, 0x6c, 0x65, 0x01, 0x00,
        0x0a, 0x4d, 0x4e, 0x5a, 0x49, 0x46, 0x2e, 0x6a,
        0x61, 0x76, 0x61, 0x01, 0x00, 0x05, 0x4d, 0x4e,
        0x5a, 0x49, 0x46, 0x01, 0x00, 0x10, 0x6a, 0x61,
        0x76, 0x61, 0x2f, 0x6c, 0x61, 0x6e, 0x67, 0x2f,
        0x4f, 0x62, 0x6a, 0x65, 0x63, 0x74, 0x01, 0x00,
        0x03, 0x4e, 0x49, 0x46, 0x01, 0x00, 0x03, 0x5a,
        0x49, 0x46, 0x06, 0x01, 0x00, 0x01, 0x00, 0x02,
        0x00, 0x02, 0x00, 0x03, 0x00, 0x04, 0x00, 0x00,
        0x00, 0x01, 0x04, 0x01, 0x00, 0x05, 0x00, 0x06,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00,
        0x00, 0x02, 0x00, 0x08}, 140
    },
    {  "public interface MZNLIF extends ZNIF, LIF [4]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0d, 0x07, 0x00, 0x09, 0x07, 0x00, 0x0a,
        0x07, 0x00, 0x0b, 0x07, 0x00, 0x0c, 0x01, 0x00,
        0x0a, 0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64, 0x46,
        0x6f, 0x75, 0x72, 0x01, 0x00, 0x03, 0x28, 0x29,
        0x56, 0x01, 0x00, 0x0a, 0x53, 0x6f, 0x75, 0x72,
        0x63, 0x65, 0x46, 0x69, 0x6c, 0x65, 0x01, 0x00,
        0x0b, 0x4d, 0x5a, 0x4e, 0x4c, 0x49, 0x46, 0x2e,
        0x6a, 0x61, 0x76, 0x61, 0x01, 0x00, 0x06, 0x4d,
        0x5a, 0x4e, 0x4c, 0x49, 0x46, 0x01, 0x00, 0x10,
        0x6a, 0x61, 0x76, 0x61, 0x2f, 0x6c, 0x61, 0x6e,
        0x67, 0x2f, 0x4f, 0x62, 0x6a, 0x65, 0x63, 0x74,
        0x01, 0x00, 0x04, 0x5a, 0x4e, 0x49, 0x46, 0x01,
        0x00, 0x03, 0x4c, 0x49, 0x46, 0x06, 0x01, 0x00,
        0x01, 0x00, 0x02, 0x00, 0x02, 0x00, 0x03, 0x00,
        0x04, 0x00, 0x00, 0x00, 0x01, 0x04, 0x01, 0x00,
        0x05, 0x00, 0x06, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x07, 0x00, 0x00, 0x00, 0x02, 0x00, 0x08}, 143
    },
    {  "public abstract class ZA []",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0d, 0x0a, 0x00, 0x03, 0x00, 0x0a, 0x07,
        0x00, 0x0b, 0x07, 0x00, 0x0c, 0x01, 0x00, 0x06,
        0x3c, 0x69, 0x6e, 0x69, 0x74, 0x3e, 0x01, 0x00,
        0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x04, 0x43,
        0x6f, 0x64, 0x65, 0x01, 0x00, 0x0f, 0x4c, 0x69,
        0x6e, 0x65, 0x4e, 0x75, 0x6d, 0x62, 0x65, 0x72,
        0x54, 0x61, 0x62, 0x6c, 0x65, 0x01, 0x00, 0x0a,
        0x53, 0x6f, 0x75, 0x72, 0x63, 0x65, 0x46, 0x69,
        0x6c, 0x65, 0x01, 0x00, 0x07, 0x5a, 0x41, 0x2e,
        0x6a, 0x61, 0x76, 0x61, 0x0c, 0x00, 0x04, 0x00,
        0x05, 0x01, 0x00, 0x02, 0x5a, 0x41, 0x01, 0x00,
        0x10, 0x6a, 0x61, 0x76, 0x61, 0x2f, 0x6c, 0x61,
        0x6e, 0x67, 0x2f, 0x4f, 0x62, 0x6a, 0x65, 0x63,
        0x74, 0x04, 0x21, 0x00, 0x02, 0x00, 0x03, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
        0x04, 0x00, 0x05, 0x00, 0x01, 0x00, 0x06, 0x00,
        0x00, 0x00, 0x1d, 0x00, 0x01, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x05, 0x2a, 0xb7, 0x00, 0x01, 0xb1,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00,
        0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x02,
        0x00, 0x09}, 178
    },
    {  "public abstract class NA [1, 2a]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0f, 0x0a, 0x00, 0x03, 0x00, 0x0c, 0x07,
        0x00, 0x0d, 0x07, 0x00, 0x0e, 0x01, 0x00, 0x06,
        0x3c, 0x69, 0x6e, 0x69, 0x74, 0x3e, 0x01, 0x00,
        0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x04, 0x43,
        0x6f, 0x64, 0x65, 0x01, 0x00, 0x0f, 0x4c, 0x69,
        0x6e, 0x65, 0x4e, 0x75, 0x6d, 0x62, 0x65, 0x72,
        0x54, 0x61, 0x62, 0x6c, 0x65, 0x01, 0x00, 0x09,
        0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64, 0x4f, 0x6e,
        0x65, 0x01, 0x00, 0x09, 0x6d, 0x65, 0x74, 0x68,
        0x6f, 0x64, 0x54, 0x77, 0x6f, 0x01, 0x00, 0x0a,
        0x53, 0x6f, 0x75, 0x72, 0x63, 0x65, 0x46, 0x69,
        0x6c, 0x65, 0x01, 0x00, 0x07, 0x4e, 0x41, 0x2e,
        0x6a, 0x61, 0x76, 0x61, 0x0c, 0x00, 0x04, 0x00,
        0x05, 0x01, 0x00, 0x02, 0x4e, 0x41, 0x01, 0x00,
        0x10, 0x6a, 0x61, 0x76, 0x61, 0x2f, 0x6c, 0x61,
        0x6e, 0x67, 0x2f, 0x4f, 0x62, 0x6a, 0x65, 0x63,
        0x74, 0x04, 0x21, 0x00, 0x02, 0x00, 0x03, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x01, 0x00,
        0x04, 0x00, 0x05, 0x00, 0x01, 0x00, 0x06, 0x00,
        0x00, 0x00, 0x1d, 0x00, 0x01, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x05, 0x2a, 0xb7, 0x00, 0x01, 0xb1,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00,
        0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x00, 0x01, 0x00, 0x08, 0x00, 0x05, 0x00, 0x01,
        0x00, 0x06, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0xb1, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00, 0x00,
        0x06, 0x00, 0x01, 0x00, 0x00, 0x00, 0x03, 0x04,
        0x01, 0x00, 0x09, 0x00, 0x05, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x02, 0x00,
        0x0b}, 249
    },
    {  "public abstract class ZNAMNZIF extends NA implements MNZIF [s]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x10, 0x0a, 0x00, 0x03, 0x00, 0x0c, 0x07,
        0x00, 0x0d, 0x07, 0x00, 0x0e, 0x07, 0x00, 0x0f,
        0x01, 0x00, 0x06, 0x3c, 0x69, 0x6e, 0x69, 0x74,
        0x3e, 0x01, 0x00, 0x03, 0x28, 0x29, 0x56, 0x01,
        0x00, 0x04, 0x43, 0x6f, 0x64, 0x65, 0x01, 0x00,
        0x0f, 0x4c, 0x69, 0x6e, 0x65, 0x4e, 0x75, 0x6d,
        0x62, 0x65, 0x72, 0x54, 0x61, 0x62, 0x6c, 0x65,
        0x01, 0x00, 0x08, 0x3c, 0x63, 0x6c, 0x69, 0x6e,
        0x69, 0x74, 0x3e, 0x01, 0x00, 0x0a, 0x53, 0x6f,
        0x75, 0x72, 0x63, 0x65, 0x46, 0x69, 0x6c, 0x65,
        0x01, 0x00, 0x0d, 0x5a, 0x4e, 0x41, 0x4d, 0x4e,
        0x5a, 0x49, 0x46, 0x2e, 0x6a, 0x61, 0x76, 0x61,
        0x0c, 0x00, 0x05, 0x00, 0x06, 0x01, 0x00, 0x08,
        0x5a, 0x4e, 0x41, 0x4d, 0x4e, 0x5a, 0x49, 0x46,
        0x01, 0x00, 0x02, 0x4e, 0x41, 0x01, 0x00, 0x05,
        0x4d, 0x4e, 0x5a, 0x49, 0x46, 0x04, 0x21, 0x00,
        0x02, 0x00, 0x03, 0x00, 0x01, 0x00, 0x04, 0x00,
        0x00, 0x00, 0x02, 0x00, 0x01, 0x00, 0x05, 0x00,
        0x06, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00, 0x00,
        0x1d, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x05, 0x2a, 0xb7, 0x00, 0x01, 0xb1, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x06,
        0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x08,
        0x00, 0x09, 0x00, 0x06, 0x00, 0x01, 0x00, 0x07,
        0x00, 0x00, 0x00, 0x20, 0x00, 0x01, 0x00, 0x01,
        0x00, 0x00, 0x00, 0x04, 0x10, 0x06, 0x3b, 0xb1,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00,
        0x00, 0x0a, 0x00, 0x02, 0x00, 0x00, 0x00, 0x03,
        0x00, 0x03, 0x00, 0x02, 0x00, 0x01, 0x00, 0x0a,
        0x00, 0x00, 0x00, 0x02, 0x00, 0x0b}, 246
    },
    {  "public class MZNAMNZIF extends ZNAMNZIF [2, 3, 4]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x10, 0x0a, 0x00, 0x03, 0x00, 0x0d, 0x07,
        0x00, 0x0e, 0x07, 0x00, 0x0f, 0x01, 0x00, 0x06,
        0x3c, 0x69, 0x6e, 0x69, 0x74, 0x3e, 0x01, 0x00,
        0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x04, 0x43,
        0x6f, 0x64, 0x65, 0x01, 0x00, 0x0f, 0x4c, 0x69,
        0x6e, 0x65, 0x4e, 0x75, 0x6d, 0x62, 0x65, 0x72,
        0x54, 0x61, 0x62, 0x6c, 0x65, 0x01, 0x00, 0x09,
        0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64, 0x54, 0x77,
        0x6f, 0x01, 0x00, 0x0b, 0x6d, 0x65, 0x74, 0x68,
        0x6f, 0x64, 0x54, 0x68, 0x72, 0x65, 0x65, 0x01,
        0x00, 0x0a, 0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64,
        0x46, 0x6f, 0x75, 0x72, 0x01, 0x00, 0x0a, 0x53,
        0x6f, 0x75, 0x72, 0x63, 0x65, 0x46, 0x69, 0x6c,
        0x65, 0x01, 0x00, 0x0e, 0x4d, 0x5a, 0x4e, 0x41,
        0x4d, 0x4e, 0x5a, 0x49, 0x46, 0x2e, 0x6a, 0x61,
        0x76, 0x61, 0x0c, 0x00, 0x04, 0x00, 0x05, 0x01,
        0x00, 0x09, 0x4d, 0x5a, 0x4e, 0x41, 0x4d, 0x4e,
        0x5a, 0x49, 0x46, 0x01, 0x00, 0x08, 0x5a, 0x4e,
        0x41, 0x4d, 0x4e, 0x5a, 0x49, 0x46, 0x00, 0x21,
        0x00, 0x02, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x04, 0x00, 0x01, 0x00, 0x04, 0x00, 0x05,
        0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0x1d,
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x05,
        0x2a, 0xb7, 0x00, 0x01, 0xb1, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x07, 0x00, 0x00, 0x00, 0x06, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
        0x08, 0x00, 0x05, 0x00, 0x01, 0x00, 0x06, 0x00,
        0x00, 0x00, 0x19, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x01, 0xb1, 0x00, 0x00, 0x00, 0x01,
        0x00, 0x07, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01,
        0x00, 0x00, 0x00, 0x03, 0x00, 0x01, 0x00, 0x09,
        0x00, 0x05, 0x00, 0x01, 0x00, 0x06, 0x00, 0x00,
        0x00, 0x19, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00,
        0x00, 0x01, 0xb1, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x07, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x06, 0x00, 0x01, 0x00, 0x0a, 0x00,
        0x05, 0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x01, 0xb1, 0x00, 0x00, 0x00, 0x01, 0x00, 0x07,
        0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00,
        0x00, 0x09, 0x00, 0x01, 0x00, 0x0b, 0x00, 0x00,
        0x00, 0x02, 0x00, 0x0c}, 340
    },
    {  "public class ZC []",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0d, 0x0a, 0x00, 0x03, 0x00, 0x0a, 0x07,
        0x00, 0x0b, 0x07, 0x00, 0x0c, 0x01, 0x00, 0x06,
        0x3c, 0x69, 0x6e, 0x69, 0x74, 0x3e, 0x01, 0x00,
        0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x04, 0x43,
        0x6f, 0x64, 0x65, 0x01, 0x00, 0x0f, 0x4c, 0x69,
        0x6e, 0x65, 0x4e, 0x75, 0x6d, 0x62, 0x65, 0x72,
        0x54, 0x61, 0x62, 0x6c, 0x65, 0x01, 0x00, 0x0a,
        0x53, 0x6f, 0x75, 0x72, 0x63, 0x65, 0x46, 0x69,
        0x6c, 0x65, 0x01, 0x00, 0x07, 0x5a, 0x43, 0x2e,
        0x6a, 0x61, 0x76, 0x61, 0x0c, 0x00, 0x04, 0x00,
        0x05, 0x01, 0x00, 0x02, 0x5a, 0x43, 0x01, 0x00,
        0x10, 0x6a, 0x61, 0x76, 0x61, 0x2f, 0x6c, 0x61,
        0x6e, 0x67, 0x2f, 0x4f, 0x62, 0x6a, 0x65, 0x63,
        0x74, 0x00, 0x21, 0x00, 0x02, 0x00, 0x03, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
        0x04, 0x00, 0x05, 0x00, 0x01, 0x00, 0x06, 0x00,
        0x00, 0x00, 0x1d, 0x00, 0x01, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x05, 0x2a, 0xb7, 0x00, 0x01, 0xb1,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00,
        0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x02,
        0x00, 0x09}, 178
    },
    {  "public class NC [s, 2, 1]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x10, 0x0a, 0x00, 0x03, 0x00, 0x0d, 0x07,
        0x00, 0x0e, 0x07, 0x00, 0x0f, 0x01, 0x00, 0x06,
        0x3c, 0x69, 0x6e, 0x69, 0x74, 0x3e, 0x01, 0x00,
        0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x04, 0x43,
        0x6f, 0x64, 0x65, 0x01, 0x00, 0x0f, 0x4c, 0x69,
        0x6e, 0x65, 0x4e, 0x75, 0x6d, 0x62, 0x65, 0x72,
        0x54, 0x61, 0x62, 0x6c, 0x65, 0x01, 0x00, 0x09,
        0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64, 0x54, 0x77,
        0x6f, 0x01, 0x00, 0x09, 0x6d, 0x65, 0x74, 0x68,
        0x6f, 0x64, 0x4f, 0x6e, 0x65, 0x01, 0x00, 0x08,
        0x3c, 0x63, 0x6c, 0x69, 0x6e, 0x69, 0x74, 0x3e,
        0x01, 0x00, 0x0a, 0x53, 0x6f, 0x75, 0x72, 0x63,
        0x65, 0x46, 0x69, 0x6c, 0x65, 0x01, 0x00, 0x07,
        0x4e, 0x43, 0x2e, 0x6a, 0x61, 0x76, 0x61, 0x0c,
        0x00, 0x04, 0x00, 0x05, 0x01, 0x00, 0x02, 0x4e,
        0x43, 0x01, 0x00, 0x10, 0x6a, 0x61, 0x76, 0x61,
        0x2f, 0x6c, 0x61, 0x6e, 0x67, 0x2f, 0x4f, 0x62,
        0x6a, 0x65, 0x63, 0x74, 0x00, 0x21, 0x00, 0x02,
        0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,
        0x00, 0x01, 0x00, 0x04, 0x00, 0x05, 0x00, 0x01,
        0x00, 0x06, 0x00, 0x00, 0x00, 0x1d, 0x00, 0x01,
        0x00, 0x01, 0x00, 0x00, 0x00, 0x05, 0x2a, 0xb7,
        0x00, 0x01, 0xb1, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x07, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x08, 0x00,
        0x05, 0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x01, 0xb1, 0x00, 0x00, 0x00, 0x01, 0x00, 0x07,
        0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00,
        0x00, 0x07, 0x00, 0x01, 0x00, 0x09, 0x00, 0x05,
        0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0x19,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0xb1, 0x00, 0x00, 0x00, 0x01, 0x00, 0x07, 0x00,
        0x00, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x0a, 0x00, 0x08, 0x00, 0x0a, 0x00, 0x05, 0x00,
        0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0x20, 0x00,
        0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x04, 0x10,
        0x06, 0x3b, 0xb1, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x07, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x02, 0x00,
        0x00, 0x00, 0x03, 0x00, 0x03, 0x00, 0x02, 0x00,
        0x01, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x02, 0x00,
        0x0c}, 337
    },
    {  "public class NZC extends ZC [1, 2, 3]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x10, 0x0a, 0x00, 0x03, 0x00, 0x0d, 0x07,
        0x00, 0x0e, 0x07, 0x00, 0x0f, 0x01, 0x00, 0x06,
        0x3c, 0x69, 0x6e, 0x69, 0x74, 0x3e, 0x01, 0x00,
        0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x04, 0x43,
        0x6f, 0x64, 0x65, 0x01, 0x00, 0x0f, 0x4c, 0x69,
        0x6e, 0x65, 0x4e, 0x75, 0x6d, 0x62, 0x65, 0x72,
        0x54, 0x61, 0x62, 0x6c, 0x65, 0x01, 0x00, 0x09,
        0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64, 0x4f, 0x6e,
        0x65, 0x01, 0x00, 0x09, 0x6d, 0x65, 0x74, 0x68,
        0x6f, 0x64, 0x54, 0x77, 0x6f, 0x01, 0x00, 0x0b,
        0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64, 0x54, 0x68,
        0x72, 0x65, 0x65, 0x01, 0x00, 0x0a, 0x53, 0x6f,
        0x75, 0x72, 0x63, 0x65, 0x46, 0x69, 0x6c, 0x65,
        0x01, 0x00, 0x08, 0x4e, 0x5a, 0x43, 0x2e, 0x6a,
        0x61, 0x76, 0x61, 0x0c, 0x00, 0x04, 0x00, 0x05,
        0x01, 0x00, 0x03, 0x4e, 0x5a, 0x43, 0x01, 0x00,
        0x02, 0x5a, 0x43, 0x00, 0x21, 0x00, 0x02, 0x00,
        0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00,
        0x01, 0x00, 0x04, 0x00, 0x05, 0x00, 0x01, 0x00,
        0x06, 0x00, 0x00, 0x00, 0x1d, 0x00, 0x01, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x05, 0x2a, 0xb7, 0x00,
        0x01, 0xb1, 0x00, 0x00, 0x00, 0x01, 0x00, 0x07,
        0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x01, 0x00, 0x08, 0x00, 0x05,
        0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0x19,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0xb1, 0x00, 0x00, 0x00, 0x01, 0x00, 0x07, 0x00,
        0x00, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x03, 0x00, 0x01, 0x00, 0x09, 0x00, 0x05, 0x00,
        0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0x19, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0xb1,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00,
        0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x00, 0x06,
        0x00, 0x01, 0x00, 0x0a, 0x00, 0x05, 0x00, 0x01,
        0x00, 0x06, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0xb1, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00, 0x00,
        0x06, 0x00, 0x01, 0x00, 0x00, 0x00, 0x09, 0x00,
        0x01, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x02, 0x00,
        0x0c}, 321
    },
    {  "public class ZNC extends NC []",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0d, 0x0a, 0x00, 0x03, 0x00, 0x0a, 0x07,
        0x00, 0x0b, 0x07, 0x00, 0x0c, 0x01, 0x00, 0x06,
        0x3c, 0x69, 0x6e, 0x69, 0x74, 0x3e, 0x01, 0x00,
        0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x04, 0x43,
        0x6f, 0x64, 0x65, 0x01, 0x00, 0x0f, 0x4c, 0x69,
        0x6e, 0x65, 0x4e, 0x75, 0x6d, 0x62, 0x65, 0x72,
        0x54, 0x61, 0x62, 0x6c, 0x65, 0x01, 0x00, 0x0a,
        0x53, 0x6f, 0x75, 0x72, 0x63, 0x65, 0x46, 0x69,
        0x6c, 0x65, 0x01, 0x00, 0x08, 0x5a, 0x4e, 0x43,
        0x2e, 0x6a, 0x61, 0x76, 0x61, 0x0c, 0x00, 0x04,
        0x00, 0x05, 0x01, 0x00, 0x03, 0x5a, 0x4e, 0x43,
        0x01, 0x00, 0x02, 0x4e, 0x43, 0x00, 0x21, 0x00,
        0x02, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x01, 0x00, 0x04, 0x00, 0x05, 0x00,
        0x01, 0x00, 0x06, 0x00, 0x00, 0x00, 0x1d, 0x00,
        0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x05, 0x2a,
        0xb7, 0x00, 0x01, 0xb1, 0x00, 0x00, 0x00, 0x01,
        0x00, 0x07, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x08,
        0x00, 0x00, 0x00, 0x02, 0x00, 0x09}, 166
    },
    {  "public class  MZCNZIF extends ZC implements NZIF [1, 4, 3, 2]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x13, 0x0a, 0x00, 0x03, 0x00, 0x0f, 0x07,
        0x00, 0x10, 0x07, 0x00, 0x11, 0x07, 0x00, 0x12,
        0x01, 0x00, 0x06, 0x3c, 0x69, 0x6e, 0x69, 0x74,
        0x3e, 0x01, 0x00, 0x03, 0x28, 0x29, 0x56, 0x01,
        0x00, 0x04, 0x43, 0x6f, 0x64, 0x65, 0x01, 0x00,
        0x0f, 0x4c, 0x69, 0x6e, 0x65, 0x4e, 0x75, 0x6d,
        0x62, 0x65, 0x72, 0x54, 0x61, 0x62, 0x6c, 0x65,
        0x01, 0x00, 0x09, 0x6d, 0x65, 0x74, 0x68, 0x6f,
        0x64, 0x4f, 0x6e, 0x65, 0x01, 0x00, 0x0a, 0x6d,
        0x65, 0x74, 0x68, 0x6f, 0x64, 0x46, 0x6f, 0x75,
        0x72, 0x01, 0x00, 0x0b, 0x6d, 0x65, 0x74, 0x68,
        0x6f, 0x64, 0x54, 0x68, 0x72, 0x65, 0x65, 0x01,
        0x00, 0x09, 0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64,
        0x54, 0x77, 0x6f, 0x01, 0x00, 0x0a, 0x53, 0x6f,
        0x75, 0x72, 0x63, 0x65, 0x46, 0x69, 0x6c, 0x65,
        0x01, 0x00, 0x0c, 0x4d, 0x5a, 0x43, 0x4e, 0x5a,
        0x49, 0x46, 0x2e, 0x6a, 0x61, 0x76, 0x61, 0x0c,
        0x00, 0x05, 0x00, 0x06, 0x01, 0x00, 0x07, 0x4d,
        0x5a, 0x43, 0x4e, 0x5a, 0x49, 0x46, 0x01, 0x00,
        0x02, 0x5a, 0x43, 0x01, 0x00, 0x04, 0x4e, 0x5a,
        0x49, 0x46, 0x00, 0x21, 0x00, 0x02, 0x00, 0x03,
        0x00, 0x01, 0x00, 0x04, 0x00, 0x00, 0x00, 0x05,
        0x00, 0x01, 0x00, 0x05, 0x00, 0x06, 0x00, 0x01,
        0x00, 0x07, 0x00, 0x00, 0x00, 0x1d, 0x00, 0x01,
        0x00, 0x01, 0x00, 0x00, 0x00, 0x05, 0x2a, 0xb7,
        0x00, 0x01, 0xb1, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x08, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x09, 0x00,
        0x06, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x01, 0xb1, 0x00, 0x00, 0x00, 0x01, 0x00, 0x08,
        0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00,
        0x00, 0x03, 0x00, 0x01, 0x00, 0x0a, 0x00, 0x06,
        0x00, 0x01, 0x00, 0x07, 0x00, 0x00, 0x00, 0x19,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
        0xb1, 0x00, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00,
        0x00, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x06, 0x00, 0x01, 0x00, 0x0b, 0x00, 0x06, 0x00,
        0x01, 0x00, 0x07, 0x00, 0x00, 0x00, 0x19, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0xb1,
        0x00, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00,
        0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x00, 0x09,
        0x00, 0x01, 0x00, 0x0c, 0x00, 0x06, 0x00, 0x01,
        0x00, 0x07, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0xb1, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00,
        0x06, 0x00, 0x01, 0x00, 0x00, 0x00, 0x0c, 0x00,
        0x01, 0x00, 0x0d, 0x00, 0x00, 0x00, 0x02, 0x00,
        0x0e}, 393
    },
    {  "public class ZNCNIF extends ZNC implements NIF []",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0f, 0x0a, 0x00, 0x03, 0x00, 0x0b, 0x07,
        0x00, 0x0c, 0x07, 0x00, 0x0d, 0x07, 0x00, 0x0e,
        0x01, 0x00, 0x06, 0x3c, 0x69, 0x6e, 0x69, 0x74,
        0x3e, 0x01, 0x00, 0x03, 0x28, 0x29, 0x56, 0x01,
        0x00, 0x04, 0x43, 0x6f, 0x64, 0x65, 0x01, 0x00,
        0x0f, 0x4c, 0x69, 0x6e, 0x65, 0x4e, 0x75, 0x6d,
        0x62, 0x65, 0x72, 0x54, 0x61, 0x62, 0x6c, 0x65,
        0x01, 0x00, 0x0a, 0x53, 0x6f, 0x75, 0x72, 0x63,
        0x65, 0x46, 0x69, 0x6c, 0x65, 0x01, 0x00, 0x0b,
        0x5a, 0x4e, 0x43, 0x4e, 0x49, 0x46, 0x2e, 0x6a,
        0x61, 0x76, 0x61, 0x0c, 0x00, 0x05, 0x00, 0x06,
        0x01, 0x00, 0x06, 0x5a, 0x4e, 0x43, 0x4e, 0x49,
        0x46, 0x01, 0x00, 0x03, 0x5a, 0x4e, 0x43, 0x01,
        0x00, 0x03, 0x4e, 0x49, 0x46, 0x00, 0x21, 0x00,
        0x02, 0x00, 0x03, 0x00, 0x01, 0x00, 0x04, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x05, 0x00,
        0x06, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00, 0x00,
        0x1d, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x05, 0x2a, 0xb7, 0x00, 0x01, 0xb1, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x06,
        0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01,
        0x00, 0x09, 0x00, 0x00, 0x00, 0x02, 0x00, 0x0a}, 184
    },
    {  "public class MNZCMZNIF extends NZC implements MZNIF [4]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x10, 0x0a, 0x00, 0x03, 0x00, 0x0c, 0x07,
        0x00, 0x0d, 0x07, 0x00, 0x0e, 0x07, 0x00, 0x0f,
        0x01, 0x00, 0x06, 0x3c, 0x69, 0x6e, 0x69, 0x74,
        0x3e, 0x01, 0x00, 0x03, 0x28, 0x29, 0x56, 0x01,
        0x00, 0x04, 0x43, 0x6f, 0x64, 0x65, 0x01, 0x00,
        0x0f, 0x4c, 0x69, 0x6e, 0x65, 0x4e, 0x75, 0x6d,
        0x62, 0x65, 0x72, 0x54, 0x61, 0x62, 0x6c, 0x65,
        0x01, 0x00, 0x0a, 0x6d, 0x65, 0x74, 0x68, 0x6f,
        0x64, 0x46, 0x6f, 0x75, 0x72, 0x01, 0x00, 0x0a,
        0x53, 0x6f, 0x75, 0x72, 0x63, 0x65, 0x46, 0x69,
        0x6c, 0x65, 0x01, 0x00, 0x0e, 0x4d, 0x4e, 0x5a,
        0x43, 0x4d, 0x5a, 0x4e, 0x49, 0x46, 0x2e, 0x6a,
        0x61, 0x76, 0x61, 0x0c, 0x00, 0x05, 0x00, 0x06,
        0x01, 0x00, 0x09, 0x4d, 0x4e, 0x5a, 0x43, 0x4d,
        0x5a, 0x4e, 0x49, 0x46, 0x01, 0x00, 0x03, 0x4e,
        0x5a, 0x43, 0x01, 0x00, 0x05, 0x4d, 0x5a, 0x4e,
        0x49, 0x46, 0x00, 0x21, 0x00, 0x02, 0x00, 0x03,
        0x00, 0x01, 0x00, 0x04, 0x00, 0x00, 0x00, 0x02,
        0x00, 0x01, 0x00, 0x05, 0x00, 0x06, 0x00, 0x01,
        0x00, 0x07, 0x00, 0x00, 0x00, 0x1d, 0x00, 0x01,
        0x00, 0x01, 0x00, 0x00, 0x00, 0x05, 0x2a, 0xb7,
        0x00, 0x01, 0xb1, 0x00, 0x00, 0x00, 0x01, 0x00,
        0x08, 0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x09, 0x00,
        0x06, 0x00, 0x01, 0x00, 0x07, 0x00, 0x00, 0x00,
        0x19, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x01, 0xb1, 0x00, 0x00, 0x00, 0x01, 0x00, 0x08,
        0x00, 0x00, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00,
        0x00, 0x03, 0x00, 0x01, 0x00, 0x0a, 0x00, 0x00,
        0x00, 0x02, 0x00, 0x0b}, 244
    },
    {  "public class XCNA extends NA []",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0d, 0x0a, 0x00, 0x03, 0x00, 0x0a, 0x07,
        0x00, 0x0b, 0x07, 0x00, 0x0c, 0x01, 0x00, 0x06,
        0x3c, 0x69, 0x6e, 0x69, 0x74, 0x3e, 0x01, 0x00,
        0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x04, 0x43,
        0x6f, 0x64, 0x65, 0x01, 0x00, 0x0f, 0x4c, 0x69,
        0x6e, 0x65, 0x4e, 0x75, 0x6d, 0x62, 0x65, 0x72,
        0x54, 0x61, 0x62, 0x6c, 0x65, 0x01, 0x00, 0x0a,
        0x53, 0x6f, 0x75, 0x72, 0x63, 0x65, 0x46, 0x69,
        0x6c, 0x65, 0x01, 0x00, 0x09, 0x58, 0x43, 0x4e,
        0x41, 0x2e, 0x6a, 0x61, 0x76, 0x61, 0x0c, 0x00,
        0x04, 0x00, 0x05, 0x01, 0x00, 0x04, 0x58, 0x43,
        0x4e, 0x41, 0x01, 0x00, 0x02, 0x4e, 0x41, 0x00,
        0x21, 0x00, 0x02, 0x00, 0x03, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x04, 0x00,
        0x05, 0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00,
        0x1d, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x05, 0x2a, 0xb7, 0x00, 0x01, 0xb1, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x07, 0x00, 0x00, 0x00, 0x06,
        0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01,
        0x00, 0x08, 0x00, 0x00, 0x00, 0x02, 0x00, 0x09}, 168
    },
    {  "public class XCZNAMNZIF extends ZNAMNZIF [3]",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0e, 0x0a, 0x00, 0x03, 0x00, 0x0b, 0x07,
        0x00, 0x0c, 0x07, 0x00, 0x0d, 0x01, 0x00, 0x06,
        0x3c, 0x69, 0x6e, 0x69, 0x74, 0x3e, 0x01, 0x00,
        0x03, 0x28, 0x29, 0x56, 0x01, 0x00, 0x04, 0x43,
        0x6f, 0x64, 0x65, 0x01, 0x00, 0x0f, 0x4c, 0x69,
        0x6e, 0x65, 0x4e, 0x75, 0x6d, 0x62, 0x65, 0x72,
        0x54, 0x61, 0x62, 0x6c, 0x65, 0x01, 0x00, 0x0b,
        0x6d, 0x65, 0x74, 0x68, 0x6f, 0x64, 0x54, 0x68,
        0x72, 0x65, 0x65, 0x01, 0x00, 0x0a, 0x53, 0x6f,
        0x75, 0x72, 0x63, 0x65, 0x46, 0x69, 0x6c, 0x65,
        0x01, 0x00, 0x0f, 0x58, 0x43, 0x5a, 0x4e, 0x41,
        0x4d, 0x4e, 0x5a, 0x49, 0x46, 0x2e, 0x6a, 0x61,
        0x76, 0x61, 0x0c, 0x00, 0x04, 0x00, 0x05, 0x01,
        0x00, 0x0a, 0x58, 0x43, 0x5a, 0x4e, 0x41, 0x4d,
        0x4e, 0x5a, 0x49, 0x46, 0x01, 0x00, 0x08, 0x5a,
        0x4e, 0x41, 0x4d, 0x4e, 0x5a, 0x49, 0x46, 0x00,
        0x21, 0x00, 0x02, 0x00, 0x03, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x02, 0x00, 0x01, 0x00, 0x04, 0x00,
        0x05, 0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00,
        0x1d, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x05, 0x2a, 0xb7, 0x00, 0x01, 0xb1, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x07, 0x00, 0x00, 0x00, 0x06,
        0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01,
        0x00, 0x08, 0x00, 0x05, 0x00, 0x01, 0x00, 0x06,
        0x00, 0x00, 0x00, 0x19, 0x00, 0x00, 0x00, 0x01,
        0x00, 0x00, 0x00, 0x01, 0xb1, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x07, 0x00, 0x00, 0x00, 0x06, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x03, 0x00, 0x01, 0x00,
        0x09, 0x00, 0x00, 0x00, 0x02, 0x00, 0x0a}, 239
    },
    {  "public class XCZNCNZIF extends ZNC implements NZIF",
       {0xca, 0xfe, 0xba, 0xbe, 0x00, 0x00, 0x00, 0x2e,
        0x00, 0x0f, 0x0a, 0x00, 0x03, 0x00, 0x0b, 0x07,
        0x00, 0x0c, 0x07, 0x00, 0x0d, 0x07, 0x00, 0x0e,
        0x01, 0x00, 0x06, 0x3c, 0x69, 0x6e, 0x69, 0x74,
        0x3e, 0x01, 0x00, 0x03, 0x28, 0x29, 0x56, 0x01,
        0x00, 0x04, 0x43, 0x6f, 0x64, 0x65, 0x01, 0x00,
        0x0f, 0x4c, 0x69, 0x6e, 0x65, 0x4e, 0x75, 0x6d,
        0x62, 0x65, 0x72, 0x54, 0x61, 0x62, 0x6c, 0x65,
        0x01, 0x00, 0x0a, 0x53, 0x6f, 0x75, 0x72, 0x63,
        0x65, 0x46, 0x69, 0x6c, 0x65, 0x01, 0x00, 0x0e,
        0x58, 0x43, 0x5a, 0x4e, 0x43, 0x4e, 0x5a, 0x49,
        0x46, 0x2e, 0x6a, 0x61, 0x76, 0x61, 0x0c, 0x00,
        0x05, 0x00, 0x06, 0x01, 0x00, 0x09, 0x58, 0x43,
        0x5a, 0x4e, 0x43, 0x4e, 0x5a, 0x49, 0x46, 0x01,
        0x00, 0x03, 0x5a, 0x4e, 0x43, 0x01, 0x00, 0x04,
        0x4e, 0x5a, 0x49, 0x46, 0x00, 0x21, 0x00, 0x02,
        0x00, 0x03, 0x00, 0x01, 0x00, 0x04, 0x00, 0x00,
        0x00, 0x01, 0x00, 0x01, 0x00, 0x05, 0x00, 0x06,
        0x00, 0x01, 0x00, 0x07, 0x00, 0x00, 0x00, 0x1d,
        0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x05,
        0x2a, 0xb7, 0x00, 0x01, 0xb1, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x08, 0x00, 0x00, 0x00, 0x06, 0x00,
        0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
        0x09, 0x00, 0x00, 0x00, 0x02, 0x00, 0x0a}, 191
    },
};

/* Forward declarations */
void buildLinkTree();

/* Main program will send the class linker through its paces */
int main(int argc, char *argv[]) {

    /* Error cases to be determined */
    /* Complex link cases, like circular references */

    /* Memory failure scanning */
#ifdef ENABLE_ERRORSWEEP
    testFailureCurrentCount = 0;
    buildLinkTree();
    failureTotal = testFailureCurrentCount;
    (void) fprintf(stderr, "Preparing to process %i memory failures\n",
                           failureTotal);
    for (testFailureCount = 1;
             testFailureCount <= failureTotal;
                 testFailureCount++) {
        testFailureCurrentCount = 0;
        buildLinkTree();
    }
#else
    buildLinkTree();
#endif

    (void) fprintf(stderr, "All tests passed successfully (%i forced)\n",
                           failureTotal);

    exit(0);
}

void buildLinkTree() {
    JEM_ParsedClassData *classData;
    int i, nOkTests = sizeof(okTests)/sizeof(struct ok_test_data);
    JEMCC_Class *testClass;
    JNIEnv *env;
#ifdef ENABLE_ERRORSWEEP
    int tmpFailCount = testFailureCount;
    int tmpFailCurrentCount = testFailureCurrentCount;
    testFailureCount = -1;
#endif

    /* Initialize operating machines */
    if ((env = createTestEnv()) == NULL) {
        (void) fprintf(stderr, 
                       "Unexpected fatal error during test env setup\n");
        exit(1);
    }
    initializeTestCoreClasses(env);

#ifdef ENABLE_ERRORSWEEP
    testFailureCount = tmpFailCount;
    testFailureCurrentCount = tmpFailCurrentCount;
#endif

    /* Parse the ok dictionary set */
    for (i = 0; i < nOkTests; i++) {
        classData = JEM_ParseClassData(env, okTests[i].testData, 
                                            okTests[i].testLength);
        if (classData == NULL) {
            if (testFailureCount < 1) {
               (void) fprintf(stderr,
                              "Unexpected fatal error parsing class %s\n",
                              okTests[i].classDef);
               exit(1);
            }
            destroyTestEnv(env);
            return;
        }
        testClass = JEM_DefineAndResolveClass(env, NULL, classData);
        if (testClass == NULL) {
            if (testFailureCount < 1) {
               (void) fprintf(stderr,
                              "Unexpected fatal error parsing class %s\n",
                              okTests[i].classDef);
               exit(1);
            }
            destroyTestEnv(env);
            return;
        }

        if (testFailureCount < 1) {
#ifdef ENABLE_ERRORSWEEP
            tmpFailCount = testFailureCount;
            testFailureCount = -1;
#endif
            (void) fprintf(stderr, "*** %s ***\n", okTests[i].classDef);
            JEM_DumpDebugClass(env, testClass);
#ifdef ENABLE_ERRORSWEEP
            testFailureCount = tmpFailCount;
#endif
        }
    }

    /* Just in case one of the tests makes it this far */
    destroyTestEnv(env);
}

/* Local methods to avoid full library inclusion */
void *JEMCC_Malloc(JNIEnv *env, juint size) {
#ifdef ENABLE_ERRORSWEEP
    if (JEM_CheckErrorSweep(ES_MEM) == JNI_TRUE) {
        (void) fprintf(stderr, "Error[local]: Simulated malloc failure\n");
        return NULL;
    }
#endif
    return calloc(1, size);
}

void JEMCC_Free(void *block) {
    free(block);
}

void JEMCC_ThrowStdThrowableIdx(JNIEnv *env, JEMCC_VMClassIndex idx,
                                JEMCC_Object *causeThrowable, const char *msg) {
    char *className = "unknown";
    if (msg == NULL) msg = "(null)";

    if (idx == JEMCC_Class_ClassNotFoundException) {
        className = "java.lang.ClassNotFoundException";
    } else if (idx == JEMCC_Class_NoClassDefFoundError) {
        className = "java.lang.NoClassDefFoundError";
    } else if (idx == JEMCC_Class_ClassFormatError) {
        className = "java.lang.ClassFormatError";
    } else {
        (void) fprintf(stderr, "Fatal error: unexpected exception index %i.\n",
                               idx);
        exit(1);
    }

    if (quietMode != JNI_FALSE) {
        (void) fprintf(stderr, "Fatal error: exception in quiet mode [%s] %s\n",
                               className, msg);
        abort();
    }
    (void) fprintf(stderr, "Error[%s]: %s.\n", className, msg);

    (void) strcpy(exClassName, className);
    (void) strcpy(exMsg, msg);
}

void JEMCC_ThrowStdThrowableByName(JNIEnv *env, JEMCC_Object *src,
                                   const char *className, 
                                   JEMCC_Object *causeThrowable,
                                   const char *msg) {
    if (msg == NULL) msg = "(null)";

    if (quietMode != JNI_FALSE) {
        (void) fprintf(stderr, "Fatal error: exception in quiet mode [%s] %s\n",
                               className, msg);
        abort();
    }
    (void) fprintf(stderr, "Error[%s]: %s.\n", className, msg);

    (void) strcpy(exClassName, className);
    (void) strcpy(exMsg, msg);
}

static char msgBuffer[1024];

void JEMCC_ThrowStdThrowableIdxV(JNIEnv *env, JEMCC_VMClassIndex idx,
                                 JEMCC_Object *causeThrowable, ...) {
    va_list ap;
    char *str;

    *msgBuffer = '\0';
    va_start(ap, causeThrowable);
    str = va_arg(ap, char *);
    while (str != NULL) {
        (void) strcat(msgBuffer, str);
        str = va_arg(ap, char *);
    }
    va_end(ap);

    JEMCC_ThrowStdThrowableIdx(env, idx, causeThrowable, msgBuffer);
}

void JEMCC_ThrowStdThrowableByNameV(JNIEnv *env, JEMCC_Object *src,
                                    const char *className,  
                                    JEMCC_Object *causeThrowable, ...) {
    va_list ap;
    char *str;

    *msgBuffer = '\0';
    va_start(ap, causeThrowable);
    str = va_arg(ap, char *);
    while (str != NULL) {
        (void) strcat(msgBuffer, str);
        str = va_arg(ap, char *);
    }
    va_end(ap);

    JEMCC_ThrowStdThrowableByName(env, src, className, causeThrowable,
                                  msgBuffer);
}

JEMCC_Object *JEMCC_AllocateObject(JNIEnv *env, JEMCC_Class *classInst,
                                   juint objDataSize) {
    JEMCC_Object *retVal = NULL;
    unsigned int totalSize = sizeof(JEMCC_Object);

    /* Add packing space for object field information */
    if (classInst != NULL) {
        totalSize += classInst->classData->packedFieldSize;
    } else {
        /* NULL case is the core class initializers - size appropriately */
        totalSize = sizeof(JEMCC_Class);
    }

    /* Create the memory space */
    if ((retVal = (JEMCC_Object *) JEMCC_Malloc(env, totalSize)) == NULL) {
        return NULL;
    }
    if (objDataSize > 0) {
        ((JEMCC_ObjectExt *) retVal)->objectData = JEMCC_Malloc(env,
                                                                objDataSize);
        if (((JEMCC_ObjectExt *) retVal)->objectData == NULL) {
            JEMCC_Free(retVal);
            return NULL;
        }
    }

    /* Initialize the main object structure elements */
    retVal->classReference = classInst;
    retVal->objStateSet = 0;

    return retVal;
}

jint JEMCC_LocateClass(JNIEnv *env, JEMCC_Object *loader, const char *className,
                       jboolean isLink, JEMCC_Class **classInst) {
    JEM_JavaVM *jvm = ((JEM_JNIEnv *) env)->parentVM;
    JEMCC_HashTable *hash = &(jvm->jemccClassPackageTable);
    jint errIdx = (isLink == JNI_FALSE) ? JEMCC_Class_ClassNotFoundException :
                                          JEMCC_Class_NoClassDefFoundError;

    /* Only need to look at the JEMCC tables */
    JEMCC_EnterSysMonitor(jvm->monitor);
    *classInst = (JEMCC_Class *) JEMCC_HashGetEntry(env, hash,
                                                    (void *) className,
                                                    JEMCC_ClassNameHashFn,
                                                    JEMCC_ClassNameEqualsFn);
    if (JEMCC_ExitSysMonitor(jvm->monitor) != JEMCC_MONITOR_OK) abort();
    if (*classInst != NULL) return JNI_OK;

    /* Not found, too bad */
    JEMCC_ThrowStdThrowableIdx(env, errIdx, NULL, className);
    return JNI_EINVAL;
}

JEMCC_Object *JEM_ExtractSkeletonThrowable(JNIEnv *env) {
    return NULL;
}

void JEMCC_ProcessThrowable(JNIEnv *env, JEMCC_Object *throwable) {
}

JEMCC_Object *JEMCC_GetInternStringUTF(JNIEnv *env,
                                       const char *utfStrData) {
    return (JEMCC_Object *) 0x08;
}
